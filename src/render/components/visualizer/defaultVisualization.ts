const path = [
    [
        [511.48237,492.86963],
        [0,159.604111],
        [90.71168,-159.463971]
    ],
    [
        [590.70284,522.97987],
        [16.00134,-29.56405],
        [76.56504,0],
        [-33.48324,57.99467],
        [-58.62437,101.540391]
    ],
    [
        [383.64286,644.29078],
        [87.60014,-151.7279],
        [-76.17157,0],
        [-11.11771,19.25643]
    ],

    [
        [476.5,620.35174],
        [-27.97241,48.44963],
        [28.6867,0]
    ],

    [
        [249.64286,644.29078],
        [87.60014,-151.727911],
        [-87.60014,0]
    ],

    [
        [250,653.21935],
        [52.28113,-90.55357],
        [48.02197,89.91093]
    ],
    [
        [140.3586,601.36768],
        [-34.83732,-60.34],
        [27.97259,-48.44995],
        [68.76002,0]
    ],
    [
        [384.35714,653.21935],
        [92.2588,-159.79692],
        [0,103.0112],
        [-32.83221,56.86705]
    ],
    [
        [178.85447,543.76456],
        [34.83733,60.3],
        [-27.97259,48.44995],
        [-68.76002,0]
    ]
];

/*const SVG_PATHS = [
 'm 415.33604,13.13485 0,159.60405 90.71168,-159.46391 z',
 'm 494.55651,43.24509 16.00134,-29.56405 76.56504,0 -33.48324,57.99467 -58.62437,101.54039 z',
 'm 287.49653,164.556 87.60014,-151.7279 -76.17157,0 -11.11771,19.25643 z',
 'm 380.35367,140.61696 -27.97241,48.44964 28.6867,0 z',
 'm 153.49653,164.556 87.60014,-151.7279 -87.60014,0 z',
 'M 153.85367,173.4846 206.1348,82.931 254.15677,172.8419 Z',
 'm 44.212271,121.6329 -34.83732,-60.34 27.97259,-48.44995 68.760019,0 z',
 'm 288.21081,173.4846 92.2588,-159.79695 0,103.0112 -32.83221,56.86705 z',
 'm 82.708141,64.02978 34.837329,60.34 -27.972589,48.44992 -68.76002,0 z'
 ];*/
const SVG_PATHS = [
    ['m', [415.33604,13.13485], [0,159.60405], [90.71168,-159.46391], 'z'],
    ['m', [494.55651,43.24509], [16.00134,-29.56405], [76.56504,0], [-33.48324,57.99467], [-58.62437,101.54039], 'z'],
    ['m', [287.49653,164.556], [87.60014,-151.7279], [-76.17157,0], [-11.11771,19.25643], 'z'],
    ['m', [380.35367,140.61696], [-27.97241,48.44964], [28.6867,0], 'z'],
    ['m', [153.49653,164.556], [87.60014,-151.7279], [-87.60014,0], 'z'],
    ['M', [153.85367,173.4846], [206.1348,82.931], [254.15677,173.4846], 'Z'],
    ['m', [44.212271,121.6329], [-34.83732,-60.34], [27.97259,-48.44995], [68.760019,0], 'z'],
    ['m', [288.21081,173.4846], [92.2588,-159.79695], [0,103.0112], [-32.83221,56.86705], 'z'],
    ['m', [82.708141,64.02978], [34.837329,60.34], [-27.972589,48.44992], [-68.76002,0], 'z'],
];

const ORIGINAL_WIDTH = 600;
const ORIGINAL_HEIGHT = 200;

let ctx;
let ft;
let ts;
let w;
let h;

function init(skqw) {
    ctx = skqw.createCanvas().getContext('2d');
}

declare var Path2D: any;

function tick(skqw) {
    w = skqw.dimensions().width;
    h = skqw.dimensions().height;
    ft = skqw.sample().ft;
    ts = skqw.sample().ts;

    ctx.strokeStyle = 'rgba(0, 200, 100, 1)';

    let scale = w / ORIGINAL_WIDTH;
    let offsetY = Math.round((h - ORIGINAL_HEIGHT * scale) / 2);
    ctx.translate(0, offsetY);
    ctx.lineWidth = scale;

    SVG_PATHS.forEach(path => {
        let svgPath = path.reduce((str: string, item: any) => {
                if (typeof item === 'string') {
                    return str + item;
                } else {
                    return str + `${item[0] * scale},${item[1] * scale} `;
                }
            }, '');

        let newPath = new Path2D(svgPath);

        ctx.stroke(newPath);
    });
    ctx.translate(0, -offsetY);
}

export const defaultVis = {
    name: 'Default Visualization',
    author: 'Michael Bromley',
    init: init,
    tick: tick
};